"use strict";
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function e(e,t,i,o){return new(i||(i=Promise))((function(l,a){function r(e){try{c(o.next(e))}catch(e){a(e)}}function n(e){try{c(o.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?l(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,n)}c((o=o.apply(e,t||[])).next())}))}(function(){return e(this,void 0,void 0,(function*(){yield figma.loadFontAsync({family:"Roboto",style:"Regular"})}))})().then(()=>{let e=figma.currentPage,t=figma.currentPage.children,i=figma.currentPage.selection;function o(e,t){figma.clientStorage.setAsync(e,JSON.stringify(t)).catch(e=>{console.log("error setting data")})}function l(t,i,o,l,a,r,n,c,s,g,f,h,d,m,p){const u=o;let y,R,S,b;if(!0===t){y=figma.createFrame(),R=figma.createFrame(),S=figma.createText(),b=figma.createText();let e=375,t=375;y.name=i,y.resize(e,t),y.layoutMode="VERTICAL",y.topRightRadius=16,y.topLeftRadius=16,y.bottomLeftRadius=16,y.bottomRightRadius=16,y.y=m,y.x=p,R.layoutMode="VERTICAL",R.resize(e,t),R.name="holder",R.horizontalPadding=16,R.verticalPadding=16,R.itemSpacing=10,S.name="Title",S.characters="Notes for "+d,S.textAlignHorizontal="CENTER",S.textAlignVertical="CENTER",S.resize(375,100),S.fontSize=16,b.name="Footer",b.characters="Chat by selecting '"+d+"' and running Chat Notes",b.textAlignHorizontal="CENTER",b.textAlignVertical="CENTER",b.resize(375,100),b.fontSize=11,b.fills=[{type:"SOLID",color:{r:85/255,g:101/255,b:117/255}}]}l=figma.createFrame(),a=figma.createFrame(),r=figma.createText(),n=figma.createText(),l.layoutMode="VERTICAL",l.layoutAlign="STRETCH",l.name="line item",l.itemSpacing=4,a.topRightRadius=24,a.topLeftRadius=24,a.bottomLeftRadius=24,a.bottomRightRadius=5,a.name="bubble",a.layoutAlign="MAX",r.characters=u,r.x=16,r.y=16,r.fontSize=13,r.name="Text",r.constraints={horizontal:"STRETCH",vertical:"STRETCH"},r.resize(r.width+2,r.height),r.textAutoResize="HEIGHT",n.characters=c,n.fills=[{type:"SOLID",color:{r:116/255,g:132/255,b:148/255}}],n.layoutAlign="MAX";let I=r.height+32,L=r.width+32;a.resize(L,I),!1===f&&("blue"===s&&(a.fills=[{type:"SOLID",color:{r:18/255,g:146/255,b:238/255}}],r.fills=[{type:"SOLID",color:{r:1,g:1,b:1}}]),"yellow"===s&&(a.fills=[{type:"SOLID",color:{r:1,g:197/255,b:85/255}}],r.fills=[{type:"SOLID",color:{r:0,g:0,b:0}}]),"orange"===s&&(a.fills=[{type:"SOLID",color:{r:1,g:145/255,b:57/255}}],r.fills=[{type:"SOLID",color:{r:1,g:1,b:1}}]),"red"===s&&(a.fills=[{type:"SOLID",color:{r:242/255,g:52/255,b:89/255}}],r.fills=[{type:"SOLID",color:{r:1,g:1,b:1}}]),"indigo"===s&&(a.fills=[{type:"SOLID",color:{r:59/255,g:100/255,b:210/255}}],r.fills=[{type:"SOLID",color:{r:1,g:1,b:1}}]),"green"===s&&(a.fills=[{type:"SOLID",color:{r:57/255,g:172/255,b:110/255}}],r.fills=[{type:"SOLID",color:{r:1,g:1,b:1}}]),"purple"===s&&(a.fills=[{type:"SOLID",color:{r:98/255,g:105/255,b:197/255}}],r.fills=[{type:"SOLID",color:{r:1,g:1,b:1}}]),"lavender"===s&&(a.fills=[{type:"SOLID",color:{r:217/255,g:220/255,b:253/255}}],r.fills=[{type:"SOLID",color:{r:0,g:0,b:0}}]),"whaletail"===s&&(a.fills=[{type:"SOLID",color:{r:114/255,g:150/255,b:225/255}}],r.fills=[{type:"SOLID",color:{r:1,g:1,b:1}}]),"lime"===s&&(a.fills=[{type:"SOLID",color:{r:194/255,g:240/255,b:215/255}}],r.fills=[{type:"SOLID",color:{r:0,g:0,b:0}}])),!0===f&&(a.fills=[{type:"SOLID",color:{r:29/255,g:43/255,b:54/255}}],r.fills=[{type:"SOLID",color:{r:1,g:1,b:1}}],a.topRightRadius=24,a.topLeftRadius=24,a.bottomLeftRadius=5,a.bottomRightRadius=24,a.layoutAlign="MIN",n.layoutAlign="MIN",n.characters=c+" 👑"),!0===h&&function(e,t,i,o,l){e.appendChild(t),t.appendChild(i),t.appendChild(o),i.appendChild(l);let a=l,r=i,n=l.height;console.log(n),a.width>315&&(r.layoutAlign="STRETCH",r.layoutMode="VERTICAL",r.horizontalPadding=16,r.verticalPadding=16,a.textAutoResize="NONE",a.resize(315,a.height),a.textAutoResize="HEIGHT")}(g,l,a,n,r),!1===h&&function(t,i,o,l,a,r,n,c){e.appendChild(t),t.appendChild(n),t.appendChild(i),t.appendChild(c),i.appendChild(o),o.appendChild(l),o.appendChild(a),l.appendChild(r);let s=r,g=l;s.width>315?(g.layoutAlign="STRETCH",g.layoutMode="VERTICAL",g.horizontalPadding=16,g.verticalPadding=16,s.textAutoResize="NONE",s.resize(315,s.height),s.textAutoResize="HEIGHT"):s.resize(s.width+2,s.height)}(y,R,l,a,n,r,S,b)}if(0===i.length)figma.closePlugin("⚠️ Please select a frame to comment on ⚠️");else{let e;figma.showUI(__html__,{width:380,height:255}),new Promise((e,t)=>{figma.clientStorage.getAsync("commentator").then(t=>{let i=t?JSON.parse(t):[];e(i),figma.ui.postMessage({commentator:i})}).catch(e=>{t(e)})}),new Promise((e,t)=>{figma.clientStorage.getAsync("color").then(t=>{let i=t?JSON.parse(t):[];e(i),figma.ui.postMessage({color:i})}).catch(e=>{t(e)})}),new Promise((e,t)=>{figma.clientStorage.getAsync("name").then(t=>{let i=t?JSON.parse(t):[];e(i),figma.ui.postMessage({name:i})}).catch(e=>{t(e)})});let a,r=0,n=0;i.forEach(t=>{"FRAME"===t.type&&(r=t.x,n=t.y,a=t.width,e=t.name,figma.ui.postMessage({getfile:e}))});let c=r+a+50,s="chatnotes__"+e;figma.ui.onmessage=i=>{if("add-message"===i.type){let a;if(t.forEach(e=>{e.name===s&&(a="found")}),"found"===a)t.forEach(t=>{"FRAME"===t.type&&t.name===s&&t.children.forEach(t=>{if("FRAME"===t.type&&"holder"===t.name){let o,a,r,g;l(!1,s,i.message,o,a,r,g,i.name,i.color,t,i.switch,!0,e,n,c)}})});else{let t,o,a,r,g;l(!0,s,i.message,t,o,a,r,i.name,i.color,g,i.switch,!1,e,n,c),figma.closePlugin()}o("color",i.color),o("name",i.name),o("commentator",i.switch)}}}});
